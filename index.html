<!doctype html>
<html lang="vi">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>·∫¢nh v·ªõi tr√°i tim xung quanh</title>
    <style>
        :root {
            --bg: #f8f8fb;
            --text: #222;
        }

        html, body {
            height: 100%;
        }

        body {
            margin: 0;
            background: radial-gradient(1200px 800px at 50% -100px, #fff 0%, var(--bg) 60%, #eef0f6 100%);
            color: var(--text);
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
            display: grid;
            place-items: center;
        }

        .stage {
            display: grid;
            gap: 16px;
            justify-items: center;
            padding: 16px;
        }

        .frame {
            position: relative;
            display: inline-block;
            overflow: visible; /* cho tr√°i tim hi·ªÉn th·ªã b√™n ngo√†i khung ·∫£nh */
            filter: drop-shadow(0 10px 24px rgba(0, 0, 0, 0.15));
            transform-style: preserve-3d;
            transition: transform 250ms ease, filter 250ms ease;
            perspective: 900px;
            isolation: isolate; /* ƒë·ªÉ l·ªõp glow ph√≠a d∆∞·ªõi kh√¥ng ·∫£nh h∆∞·ªüng */
        }

        /* Glow m·ªÅm ph√≠a sau ·∫£nh */
        .frame::before {
            content: "";
            position: absolute;
            inset: -28px;
            border-radius: 28px;
            background:
                radial-gradient(60% 60% at 30% 20%, rgba(255, 0, 102, .35), transparent 70%),
                radial-gradient(50% 50% at 80% 60%, rgba(255, 180, 0, .28), transparent 70%),
                radial-gradient(45% 45% at 50% 90%, rgba(153, 102, 255, .18), transparent 70%);
            filter: blur(26px) saturate(120%);
            z-index: -1;
            pointer-events: none;
        }

        .photo {
            display: block;
            max-width: min(78vw, 420px);
            height: auto;
            border-radius: 16px;
            box-shadow: 0 10px 24px rgba(0,0,0,.18), 0 2px 8px rgba(0,0,0,.08) inset;
            transform-origin: center;
            animation: kenburns 24s ease-in-out infinite alternate;
        }

        @keyframes kenburns {
            0% { transform: translate3d(-1%, -1%, 0) scale(1); }
            100% { transform: translate3d(1.5%, 1.5%, 0) scale(1.08); }
        }

        .hearts-layer {
            position: absolute;
            inset: 0;
            pointer-events: none;
            overflow: visible;
            transform-origin: center;
            animation: ring-rotate 36s linear infinite;
        }

        @keyframes ring-rotate {
            from { transform: rotate(0deg) translateZ(0); }
            to { transform: rotate(360deg) translateZ(0); }
        }

        .heart {
            position: absolute;
            left: 50%;
            top: 50%;
            translate: -50% -50%;
            font-size: 18px; /* s·∫Ω ƒë∆∞·ª£c thay ƒë·ªïi b·∫±ng JS */
            line-height: 1;
            will-change: transform, opacity;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,.2));
            animation: pulse 2.6s ease-in-out infinite;
        }

        /* Xoay emoji ƒë·ªÉ nh√¨n h∆∞·ªõng ra ngo√†i ƒë∆∞·ªùng tr√≤n */
        .heart { transform: rotate(var(--deg, 0deg)) scale(var(--scale, 1)); }

        @keyframes pulse {
            0%, 100% { transform: rotate(var(--deg, 0deg)) scale(calc(var(--scale, 1) * 1)); opacity: .95; }
            50% { transform: rotate(var(--deg, 0deg)) scale(calc(var(--scale, 1) * 1.18)); opacity: 1; }
        }

        /* L·∫•p l√°nh */
        .sparkle {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: radial-gradient(circle, #fff 0%, rgba(255,255,255,.8) 40%, rgba(255,255,255,0) 70%);
            filter: drop-shadow(0 0 8px rgba(255,255,255,.9));
            opacity: .85;
            pointer-events: none;
            animation: twinkle 2.2s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { transform: scale(0.9); opacity: .45; }
            50% { transform: scale(1.35); opacity: 1; }
        }

        .caption { opacity: .75; font-size: 14px; }
    </style>
</head>
<body>
    <div class="stage">
        <div class="frame" id="frame">
            <img class="photo" id="photo" src="./2a1a7694-cb78-4695-ac64-5638325e5f84.jpg" alt="·∫¢nh">
            <div class="hearts-layer" id="hearts"></div>
        </div>
        <div class="caption"></div>
    </div>

    <script>
    (function () {
        const img = document.getElementById('photo');
        const layer = document.getElementById('hearts');
        const frame = document.getElementById('frame');

        function placeHeartsAndSparkles() {
            layer.innerHTML = '';

            const width = img.naturalWidth ? Math.min(img.naturalWidth, img.clientWidth) : img.clientWidth;
            const height = img.naturalHeight ? Math.min(img.naturalHeight, img.clientHeight) : img.clientHeight;

            // B√°n k√≠nh elip l·ªõn h∆°n ·∫£nh m·ªôt ch√∫t ƒë·ªÉ tr√°i tim n·∫±m "xung quanh" ·∫£nh
            const padding = Math.max(20, Math.round(Math.min(width, height) * 0.12));
            const rx = width / 2 + padding;
            const ry = height / 2 + padding * 0.9;

            // S·ªë l∆∞·ª£ng tr√°i tim (t·ªâ l·ªá theo k√≠ch th∆∞·ªõc ·∫£nh)
            const count = Math.max(18, Math.round((width + height) / 36));

            for (let i = 0; i < count; i++) {
                const theta = (i / count) * Math.PI * 2; // g√≥c theo radian
                const x = width / 2 + rx * Math.cos(theta);
                const y = height / 2 + ry * Math.sin(theta);

                const span = document.createElement('span');
                span.className = 'heart';
                span.textContent = Math.random() < 0.35 ? 'üíñ' : '‚ù§';

                // Xoay tr√°i tim h∆∞·ªõng ra ngo√†i (vu√¥ng g√≥c v·ªõi ti·∫øp tuy·∫øn c·ªßa elip)
                const deg = (theta * 180 / Math.PI) + 90;
                const size = 16 + Math.random() * 10; // px
                const scale = 0.92 + Math.random() * 0.25;

                span.style.setProperty('--deg', deg.toFixed(2) + 'deg');
                span.style.setProperty('--scale', scale.toFixed(2));
                span.style.fontSize = size.toFixed(0) + 'px';
                span.style.left = x + 'px';
                span.style.top = y + 'px';
                span.style.animationDelay = (Math.random() * 1.8).toFixed(2) + 's';

                layer.appendChild(span);
            }

            // T·∫°o l·∫•p l√°nh quanh vi·ªÅn elip
            const sparkles = Math.max(18, Math.round(count * 0.8));
            for (let i = 0; i < sparkles; i++) {
                const t = Math.random() * Math.PI * 2;
                const jitter = (Math.random() - 0.5) * padding * 0.25;
                const x = width / 2 + (rx + jitter) * Math.cos(t);
                const y = height / 2 + (ry + jitter) * Math.sin(t);
                const s = document.createElement('i');
                s.className = 'sparkle';
                s.style.left = x + 'px';
                s.style.top = y + 'px';
                s.style.width = s.style.height = (3 + Math.random() * 4).toFixed(0) + 'px';
                s.style.animationDelay = (Math.random() * 2).toFixed(2) + 's';
                layer.appendChild(s);
            }
        }

        // Nghi√™ng 3D theo chu·ªôt
        let rafId = 0;
        function onMove(e) {
            const rect = frame.getBoundingClientRect();
            const cx = rect.left + rect.width / 2;
            const cy = rect.top + rect.height / 2;
            const dx = (e.clientX - cx) / rect.width; // -0.5..0.5
            const dy = (e.clientY - cy) / rect.height;
            const maxX = 12; // deg
            const maxY = 18; // deg
            const rotX = (-dy) * maxX;
            const rotY = dx * maxY;
            cancelAnimationFrame(rafId);
            rafId = requestAnimationFrame(() => {
                frame.style.transform = `perspective(900px) rotateX(${rotX}deg) rotateY(${rotY}deg)`;
                frame.style.filter = 'drop-shadow(0 18px 30px rgba(0,0,0,.18))';
            });
        }
        function onLeave() {
            frame.style.transform = 'perspective(900px) rotateX(0deg) rotateY(0deg)';
            frame.style.filter = 'drop-shadow(0 10px 24px rgba(0,0,0,.15))';
        }
        frame.addEventListener('mousemove', onMove);
        frame.addEventListener('mouseleave', onLeave);

        // Khi ·∫£nh t·∫£i xong ho·∫∑c khi resize, v·∫Ω l·∫°i tr√°i tim & l·∫•p l√°nh
        if (img.complete) {
            placeHeartsAndSparkles();
        } else {
            img.addEventListener('load', placeHeartsAndSparkles, { once: true });
        }
        window.addEventListener('resize', placeHeartsAndSparkles);
    })();
    </script>
</body>
</html>


